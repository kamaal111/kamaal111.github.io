<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>Kamaal Farah</title><meta name="next-head-count" content="3"/><link rel="preload" href="/_next/static/css/e0c1e161787eff0f.css" as="style"/><link rel="stylesheet" href="/_next/static/css/e0c1e161787eff0f.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-57d1094f66c442d9.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-e95be0cae5109b70.js" defer=""></script><script src="/_next/static/chunks/pages/_app-4fac5b4317645986.js" defer=""></script><script src="/_next/static/chunks/570-e409764dcf26503f.js" defer=""></script><script src="/_next/static/chunks/pages/content/blogs/solvingCoreDataRaceConditions-93ab9f0b80c4c626.js" defer=""></script><script src="/_next/static/l-NpHueRtNnPakic4XAtV/_buildManifest.js" defer=""></script><script src="/_next/static/l-NpHueRtNnPakic4XAtV/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="header"><div class="home-link"><a href="/">Kamaal Farah</a></div><div class="menu-links"><a href="/projects/">Projects</a><a href="/blogs/">Blogs</a><a href="/cheat-sheet/">Cheat sheet</a></div></div><main><h1 class="title">Solving CoreData race conditions</h1><p>Ever seen this error when your application using CoreData crashes?</p><p><code>fault: NULL _cd_rawData but the object is not being turned into a fault</code></p><p>This happens when you&#x27;re trying to access the managed entry on a thread that the <code>NSManagedObjectContext</code> is not on.</p><h2>Solution</h2><p>Well this how solved it for myself.</p><p>You&#x27;ll need to have access to <code>NSManagedObjectContext</code> of the CoreData entry you&#x27;re trying to access. I use singleton
class that I can use through my app called <code>PersistenceController</code>.</p><p>Secondly I try to determine the failure point of this race condition. Then at the point where I have access to the
<code>NSManagedObjectContext</code> and the Coredata entry I wrap this point in the following.</p><div class="copyable-code"><button type="button" class="copy-button"><i class="fa fa-2x fa-clipboard copy-icon"></i></button><pre><code class="hljs language-swift"><span class="hljs-keyword">await</span> <span class="hljs-type">PersistenceController</span>.shared.context.perform {
    <span class="hljs-comment">// whatever code you where performing</span>
}
</code></pre></div><p>Now that I&#x27;m performing the action I wanted in the <code>perform</code> block, I can safely assume that we have no more race conditions
in this case.</p></main><footer><div><p>â’¸ 2020-2022 Kamaal Farah</p></div></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{}},"page":"/content/blogs/solvingCoreDataRaceConditions","query":{},"buildId":"l-NpHueRtNnPakic4XAtV","nextExport":true,"autoExport":true,"isFallback":false,"scriptLoader":[]}</script></body></html>